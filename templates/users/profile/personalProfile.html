{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/users/personalProfile.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link href="{% static 'fontawesomefree/css/fontawesome.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'fontawesomefree/css/brands.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'fontawesomefree/css/solid.css' %}" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <script src="{% static 'js/jquery-3.4.1.min.js' %}"></script>
    <script src="{% static 'js/jquery.mask.min.js' %}"></script>
    <title>Informações de Perfil</title>
</head>
<body>
    <div class="div-icon-accessibility">
        <i class="fa-sharp fa-solid fa-universal-access"></i>
    </div>
    <div class="body">
        <div class="form-div">
            <form action="{% url 'signup2' %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="div-row">
                    <div class="div-column">
                        <div class="photo">
                            <div class="photo__div">
                                <i class="fa-solid fa-user icon"></i>
                            </div>
                        </div>
                        <label class="picture" for="foto" tabindex="0">
                            <span class="picture__image">Escolha uma imagem</span>
                        </label>
                        <input type="file" id="foto" class="file"/>
                    </div>
                    <div class="div-column">
                        <div class="form-field">
                            <label for="cpf">CPF:</label>
                            <div class="form-input">
                                <input type="text" name="cpf" id="cpf" required>
                            </div>
                        </div>
                        <div class="form-field">
                            <label for="rg">RG:</label>
                            <div class="form-input">
                                <input type="text" name="rg" id="rg" required>
                            </div>
                        </div>
                        <div class="form-field">
                            <label for="birthdate">Data de Nascimento:</label>
                            <div class="form-input">
                                <input type="date" name="birthdate" required>
                            </div>
                        </div>
                    </div>                
                </div>

                <div class="div-row">
                    <div class="form-field">
                    <label for="gender">Gênero:</label>
                        <div class="form-input">
                            <select name="gender" id="gender" class="form-control">
                                <option value="" disabled selected>Selecione o gênero</option>
                                <option value="masculino">Masculino</option>
                                <option value="feminino">Feminino</option>
                                <option value="transgenero">Transgênero</option>
                                <option value="outros">Outros</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-field form-ethnicity">
                        <label for="ethnicity">Etnia:</label>
                        <div class="form-input">
                            <select name="ethnicity" id="ethnicity" class="form-control">
                                <option value="" disabled selected>Selecione a entia</option>
                                <option value="branco">Branco</option>
                                <option value="preto">Preto</option>
                                <option value="indigena">Indígena</option>
                                <option value="pardo">Pardo</option>
                                <option value="amarelo">Amarelo</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="div-row">
                    <div class="form-field">
                        <label for="state">Estado:</label>
                        <div class="form-input">
                            <select name="state" id="state" class="form-control">
                                <option value="" disabled selected>Selecione o estado</option>
                                <option value="AC">AC</option>
                                <option value="AL">AL</option>
                                <option value="AP">AP</option>
                                <option value="AM">AM</option>
                                <option value="BA">BA</option>
                                <option value="CE">CE</option>
                                <option value="DF">DF</option>
                                <option value="ES">ES</option>
                                <option value="GO">GO</option>
                                <option value="MA">MA</option>
                                <option value="MT">MT</option>
                                <option value="MS">MS</option>
                                <option value="MG">MG</option>
                                <option value="PA">PA</option>
                                <option value="PB">PB</option>
                                <option value="PR">PR</option>
                                <option value="PE">PE</option>
                                <option value="PI">PI</option>
                                <option value="RJ">RJ</option>
                                <option value="RN">RN</option>
                                <option value="RS">RS</option>
                                <option value="RO">RO</option>
                                <option value="RR">RR</option>
                                <option value="SC">SC</option>
                                <option value="SP">SP</option>
                                <option value="SE">SE</option>
                                <option value="TO">TO</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-field form-city">
                        <label for="city">Cidade:</label>
                        <div class="form-input">
                            <select name="city" id="city" class="form-control">
                                <option value="" disabled selected>Selecione a cidade</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="div-row">
                    <div class="form-field">
                        <label for="is_disabled">Possui deficiência?</label>
                        <div class="form-input">
                            <select name="is_disabled" id="is_disabled" class="form-control">
                                <option value="" disabled selected>Selecione uma opção</option>
                                <option value="True">Sim</option>
                                <option value="False">Não</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-field">
                        <label for="disabled">Qual deficiência?</label>
                        <div class="form-input">
                            <input type="text" name="disabled" placeholder="Visual">
                        </div>
                    </div>
                </div>

                <div class="div-button">
                    <button type="submit" class="button">Salvar</button>
                    <button type="button" class="button">Cancelar</button>
                </div>
            </form>
        </div>
    </div>
</body>

<script>
    const inputFile = document.querySelector("#foto");
    

    inputFile.addEventListener("change", function(e){
        var divPhoto = document.querySelector(".photo__div");
        const inputTarget = e.target;
        const file = inputTarget.files[0];

        if (file) {
            const reader = new FileReader();

            reader.addEventListener("load", function(e){
                const readerTarget = e.target;

                const img = document.createElement("img");
                img.src = readerTarget.result;
                img.classList.add("photo-img");

                divPhoto.innerHTML = "";
                divPhoto.appendChild(img);
            })

            reader.readAsDataURL(file);
        }
    })

    var state = document.querySelector("#state");

    state.addEventListener("change", function(e){
        let url = `https://servicodados.ibge.gov.br/api/v1/localidades/estados/${state.value}/municipios`
        $("#city").empty();
        $("#city").append(`<option value="" disabled selected>Selecione a cidade</option>`);

        let conteudo = "<optiongroup>";
        $.getJSON(url, function(data){
            $.each(data, function(k, v){
                $("#city").append( `<option value="${v.nome}">${v.nome}</option>`);
            });
        });
    });

    $("#cpf").mask('000.000.000-00');
    $("#rg").mask('00.000.000-0');

</script>
</html>